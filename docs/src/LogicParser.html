<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">LogicParser</span><span> </span><span class="hs-special">(</span><a href="LogicParser.html#parseFProp"><span class="hs-identifier hs-var">parseFProp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="Logic.html"><span class="hs-identifier">Logic</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span class="hs-operator">.</span><span class="hs-identifier">Expr</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span class="hs-operator">.</span><span class="hs-identifier">Token</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Token</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Parsec</span><span class="hs-operator">.</span><span class="hs-identifier">Language</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- Language definition</span><span>
</span><a name="line-11"></a><a name="def"><a href="LogicParser.html#def"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">emptyDef</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">identStart</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">letter</span><span>
</span><a name="line-12"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">identLetter</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alphaNum</span><span>
</span><a name="line-13"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">opStart</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">oneOf</span><span> </span><span class="hs-string">&quot;&amp;|&gt;=~&quot;</span><span>
</span><a name="line-14"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">opLetter</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">oneOf</span><span> </span><span class="hs-string">&quot;&amp;|&gt;=~&quot;</span><span>
</span><a name="line-15"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reservedOpNames</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&amp;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;~&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-16"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">reservedNames</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;F&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-17"></a><span>               </span><span class="hs-special">}</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">-- Lexer based on that definition</span><span>
</span><a name="line-20"></a><a name="lexer"><a href="LogicParser.html#lexer"><span class="hs-identifier">lexer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">makeTokenParser</span><span> </span><a href="LogicParser.html#def"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- Parsers</span><span>
</span><a name="line-23"></a><a name="m_parens"><a href="LogicParser.html#m_parens"><span class="hs-identifier">m_parens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Token</span><span class="hs-operator">.</span><span class="hs-identifier">parens</span><span> </span><a href="LogicParser.html#lexer"><span class="hs-identifier hs-var">lexer</span></a><span>
</span><a name="line-24"></a><a name="m_reserved"><a href="LogicParser.html#m_reserved"><span class="hs-identifier">m_reserved</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Token</span><span class="hs-operator">.</span><span class="hs-identifier">reserved</span><span> </span><a href="LogicParser.html#lexer"><span class="hs-identifier hs-var">lexer</span></a><span>
</span><a name="line-25"></a><a name="m_reservedOp"><a href="LogicParser.html#m_reservedOp"><span class="hs-identifier">m_reservedOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Token</span><span class="hs-operator">.</span><span class="hs-identifier">reservedOp</span><span> </span><a href="LogicParser.html#lexer"><span class="hs-identifier hs-var">lexer</span></a><span>
</span><a name="line-26"></a><a name="m_identifier"><a href="LogicParser.html#m_identifier"><span class="hs-identifier">m_identifier</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Token</span><span class="hs-operator">.</span><span class="hs-identifier">identifier</span><span> </span><a href="LogicParser.html#lexer"><span class="hs-identifier hs-var">lexer</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-identifier">expr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Logic.html#FProp"><span class="hs-identifier hs-type">FProp</span></a><span>
</span><a name="line-29"></a><a name="expr"><a href="LogicParser.html#expr"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">buildExpressionParser</span><span> </span><a href="LogicParser.html#table"><span class="hs-identifier hs-var">table</span></a><span> </span><a href="LogicParser.html#term"><span class="hs-identifier hs-var">term</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><a name="term"><a href="LogicParser.html#term"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LogicParser.html#m_parens"><span class="hs-identifier hs-var">m_parens</span></a><span> </span><a href="LogicParser.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="LogicParser.html#atomicTerm"><span class="hs-identifier hs-var">atomicTerm</span></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><a name="atomicTerm"><a href="LogicParser.html#atomicTerm"><span class="hs-identifier">atomicTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LogicParser.html#literalTerm"><span class="hs-identifier hs-var">literalTerm</span></a><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="LogicParser.html#identifierTerm"><span class="hs-identifier hs-var">identifierTerm</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><a name="literalTerm"><a href="LogicParser.html#literalTerm"><span class="hs-identifier">literalTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="LogicParser.html#m_reserved"><span class="hs-identifier hs-var">m_reserved</span></a><span> </span><span class="hs-string">&quot;T&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Logic.html#T"><span class="hs-identifier hs-var">T</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>          </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><a href="LogicParser.html#m_reserved"><span class="hs-identifier hs-var">m_reserved</span></a><span> </span><span class="hs-string">&quot;F&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Logic.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><a name="identifierTerm"><a href="LogicParser.html#identifierTerm"><span class="hs-identifier">identifierTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Logic.html#Atom"><span class="hs-identifier hs-var">Atom</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="LogicParser.html#m_identifier"><span class="hs-identifier hs-var">m_identifier</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- Operator table, from biggest to lowest priority</span><span>
</span><a name="line-41"></a><a name="table"><a href="LogicParser.html#table"><span class="hs-identifier">table</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><a href="LogicParser.html#prefix"><span class="hs-identifier hs-var">prefix</span></a><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><a href="Logic.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-42"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><a href="LogicParser.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><span class="hs-string">&quot;&amp;&quot;</span><span> </span><a href="Logic.html#Conj"><span class="hs-identifier hs-var">Conj</span></a><span> </span><span class="hs-identifier hs-var">AssocLeft</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-43"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><a href="LogicParser.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><a href="Logic.html#Disj"><span class="hs-identifier hs-var">Disj</span></a><span>  </span><span class="hs-identifier hs-var">AssocLeft</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><a href="LogicParser.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span> </span><a href="Logic.html#Impl"><span class="hs-identifier hs-var">Impl</span></a><span> </span><span class="hs-identifier hs-var">AssocLeft</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-45"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><a href="LogicParser.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><span class="hs-string">&quot;&lt;-&gt;&quot;</span><span> </span><a href="Logic.html#Equi"><span class="hs-identifier hs-var">Equi</span></a><span> </span><span class="hs-identifier hs-var">AssocLeft</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-46"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><a name="binary"><a href="LogicParser.html#binary"><span class="hs-identifier">binary</span></a></a><span>  </span><a name="local-6989586621679077561"><a href="#local-6989586621679077561"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679077562"><a href="#local-6989586621679077562"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679077563"><a href="#local-6989586621679077563"><span class="hs-identifier">assoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Infix</span><span>   </span><span class="hs-special">(</span><a href="LogicParser.html#m_reservedOp"><span class="hs-identifier hs-var">m_reservedOp</span></a><span> </span><a href="#local-6989586621679077561"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679077562"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679077563"><span class="hs-identifier hs-var">assoc</span></a><span>
</span><a name="line-49"></a><a name="prefix"><a href="LogicParser.html#prefix"><span class="hs-identifier">prefix</span></a></a><span>  </span><a name="local-6989586621679077564"><a href="#local-6989586621679077564"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679077565"><a href="#local-6989586621679077565"><span class="hs-identifier">fun</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>  </span><span class="hs-special">(</span><a href="LogicParser.html#m_reservedOp"><span class="hs-identifier hs-var">m_reservedOp</span></a><span> </span><a href="#local-6989586621679077564"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679077565"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><a name="postfix"><a href="LogicParser.html#postfix"><span class="hs-identifier">postfix</span></a></a><span> </span><a name="local-6989586621679077566"><a href="#local-6989586621679077566"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679077567"><a href="#local-6989586621679077567"><span class="hs-identifier">fun</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Postfix</span><span> </span><span class="hs-special">(</span><a href="LogicParser.html#m_reservedOp"><span class="hs-identifier hs-var">m_reservedOp</span></a><span> </span><a href="#local-6989586621679077566"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679077567"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- Parser</span><span>
</span><a name="line-53"></a><span class="hs-identifier">parseFProp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">ParseError</span><span> </span><a href="Logic.html#FProp"><span class="hs-identifier hs-type">FProp</span></a><span>
</span><a name="line-54"></a><a name="parseFProp"><a href="LogicParser.html#parseFProp"><span class="hs-identifier">parseFProp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parse</span><span> </span><a href="LogicParser.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-string">&quot;&quot;</span></pre></body></html>